<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>3-Minute Conflict Pair Diagnostic | Logos & Praxis</title>
  
  <!-- Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-QEWYMTSMJQ"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-QEWYMTSMJQ');
  </script>
  
  <meta name="theme-color" content="#0B0B0C">
  <meta name="description" content="Discover your constraint pattern in 3 minutes. Take the free conflict pair diagnostic.">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  
  <style>
    :root {
      --bg: #0B0B0C;
      --ink: #E5E7EB;
      --muted: #9CA3AF;
      --stroke: rgba(229, 231, 235, 0.28);
      --accent: #2563EB;
      --space-8: 8px;
      --space-12: 12px;
      --space-16: 16px;
      --space-24: 24px;
      --space-32: 32px;
      --space-48: 48px;
      --space-64: 64px;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      background: var(--bg);
      color: var(--ink);
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
      line-height: 1.6;
      -webkit-font-smoothing: antialiased;
    }

    .container {
      max-width: 720px;
      margin: 0 auto;
      padding: var(--space-48) var(--space-24);
    }

    /* Logo */
    .logo-glyph {
      width: 80px;
      height: auto;
      margin: 0 auto var(--space-32) auto;
      display: block;
      opacity: 0.9;
    }

    /* Header */
    .header {
      text-align: center;
      margin-bottom: var(--space-64);
    }

    .header h1 {
      font-size: clamp(32px, 6vw, 48px);
      font-weight: 700;
      line-height: 1.1;
      letter-spacing: -0.02em;
      margin-bottom: var(--space-16);
    }

    .header p {
      font-size: clamp(16px, 3vw, 18px);
      color: var(--muted);
      line-height: 1.5;
      max-width: 560px;
      margin: 0 auto;
    }

    /* Progress Bar */
    .progress-container {
      margin-bottom: var(--space-48);
    }

    .progress-bar {
      height: 4px;
      background: var(--stroke);
      border-radius: 999px;
      overflow: hidden;
    }

    .progress-fill {
      height: 100%;
      background: var(--accent);
      width: 0%;
      transition: width 0.3s ease;
    }

    .progress-text {
      text-align: center;
      margin-top: var(--space-12);
      font-size: 14px;
      color: var(--muted);
    }

    /* Question Section */
    .question-section {
      display: none;
    }

    .question-section.active {
      display: block;
    }

    .question-title {
      font-size: clamp(20px, 4vw, 28px);
      font-weight: 600;
      margin-bottom: var(--space-24);
      color: var(--ink);
    }

    .question-subtitle {
      font-size: 16px;
      color: var(--muted);
      margin-bottom: var(--space-32);
      line-height: 1.6;
    }

    /* Options */
    .options-container {
      display: flex;
      flex-direction: column;
      gap: var(--space-12);
    }

    .option-card {
      padding: var(--space-16) var(--space-24);
      background: rgba(229, 231, 235, 0.03);
      border: 2px solid var(--stroke);
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.2s ease;
      font-size: 16px;
      color: var(--ink);
      text-align: left;
    }

    .option-card:hover {
      background: rgba(229, 231, 235, 0.05);
      border-color: var(--accent);
      transform: translateX(4px);
    }

    .option-card.selected {
      background: rgba(37, 99, 235, 0.1);
      border-color: var(--accent);
    }

    /* Result Section */
    .result-section {
      display: none;
    }

    .result-section.active {
      display: block;
    }

    .result-header {
      text-align: center;
      margin-bottom: var(--space-48);
    }

    .result-title {
      font-size: clamp(28px, 5vw, 42px);
      font-weight: 700;
      color: var(--accent);
      margin-bottom: var(--space-16);
      line-height: 1.2;
    }

    .result-subtitle {
      font-size: 18px;
      color: var(--muted);
    }

    .result-block {
      background: rgba(229, 231, 235, 0.03);
      border: 1px solid var(--stroke);
      border-radius: 12px;
      padding: var(--space-32);
      margin-bottom: var(--space-24);
    }

    .result-label {
      font-size: 12px;
      font-weight: 700;
      color: var(--muted);
      text-transform: uppercase;
      letter-spacing: 0.05em;
      margin-bottom: var(--space-12);
    }

    .result-content {
      font-size: 17px;
      color: var(--ink);
      line-height: 1.7;
    }

    .result-content strong {
      color: var(--accent);
      font-weight: 600;
    }

    .result-highlight {
      background: rgba(37, 99, 235, 0.05);
      border-left: 4px solid var(--accent);
      padding: var(--space-24);
      border-radius: 8px;
      margin: var(--space-32) 0;
    }

    .result-highlight p {
      font-size: 18px;
      color: var(--ink);
      line-height: 1.7;
      margin: 0;
    }

    /* CTA */
    .cta-pill {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: var(--space-12);
      background: var(--accent);
      color: white;
      padding: 18px 36px;
      border-radius: 999px;
      font-size: 18px;
      font-weight: 600;
      text-decoration: none;
      transition: all 0.2s ease;
      border: none;
      cursor: pointer;
      width: 100%;
      margin-top: var(--space-32);
    }

    .cta-pill:hover {
      background: #1e40af;
      transform: translateY(-2px);
      box-shadow: 0 8px 24px rgba(37, 99, 235, 0.3);
    }

    .cta-secondary {
      background: transparent;
      color: var(--ink);
      border: 1px solid var(--stroke);
      margin-top: var(--space-16);
    }

    .cta-secondary:hover {
      background: rgba(229, 231, 235, 0.05);
      border-color: var(--accent);
      color: var(--accent);
      transform: translateY(-1px);
    }

    /* Email Capture */
    .email-capture {
      margin: var(--space-48) 0;
      padding: var(--space-32);
      background: rgba(16, 185, 129, 0.05);
      border: 1px solid rgba(16, 185, 129, 0.3);
      border-radius: 12px;
    }

    .email-capture h3 {
      font-size: 20px;
      font-weight: 600;
      margin-bottom: var(--space-16);
      color: var(--ink);
    }

    .email-capture p {
      font-size: 15px;
      color: var(--muted);
      margin-bottom: var(--space-24);
      line-height: 1.6;
    }

    .email-form {
      display: flex;
      gap: var(--space-12);
    }

    .email-form input[type="email"] {
      flex: 1;
      background: rgba(229, 231, 235, 0.03);
      border: 1px solid var(--stroke);
      border-radius: 8px;
      padding: 14px 16px;
      font-family: 'Inter', sans-serif;
      font-size: 16px;
      color: var(--ink);
      transition: all 0.2s ease;
    }

    .email-form input[type="email"]:focus {
      outline: none;
      border-color: var(--accent);
      background: rgba(229, 231, 235, 0.05);
    }

    .email-form button {
      background: #10b981;
      color: white;
      border: none;
      border-radius: 8px;
      padding: 14px 24px;
      font-family: 'Inter', sans-serif;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s ease;
      white-space: nowrap;
    }

    .email-form button:hover {
      background: #059669;
      transform: translateY(-1px);
    }

    .email-success {
      display: none;
      color: #10b981;
      font-size: 14px;
      margin-top: var(--space-12);
    }

    .email-success.show {
      display: block;
    }

    @media (max-width: 640px) {
      .email-form {
        flex-direction: column;
      }

      .email-form button {
        width: 100%;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <img src="/assets/logospraxis-glyph.png" alt="Logos & Praxis" class="logo-glyph">

    <!-- HEADER -->
    <div class="header">
      <h1>3-Minute Conflict Pair Diagnostic</h1>
      <p>Discover your constraint pattern. Free. Instant results.</p>
    </div>

    <!-- PROGRESS BAR -->
    <div class="progress-container">
      <div class="progress-bar">
        <div class="progress-fill" id="progressFill"></div>
      </div>
      <div class="progress-text" id="progressText">Question 1 of 3</div>
    </div>

    <!-- QUESTION 1: Physical Alarm -->
    <div class="question-section active" id="question1">
      <h2 class="question-title">What physical signal do you notice when work feels "off"?</h2>
      <p class="question-subtitle">This is your alarm. Your body knows before your mind does.</p>
      
      <div class="options-container">
        <div class="option-card" data-q="q1" data-value="jaw">
          Jaw clenches
        </div>
        <div class="option-card" data-q="q1" data-value="breathing">
          Breathing shallows
        </div>
        <div class="option-card" data-q="q1" data-value="chest">
          Chest tightens
        </div>
        <div class="option-card" data-q="q1" data-value="time">
          Time distorts
        </div>
      </div>
    </div>

    <!-- QUESTION 2: Triggering Activity -->
    <div class="question-section" id="question2">
      <h2 class="question-title">What were you doing right before that signal fired?</h2>
      <p class="question-subtitle">The activity that triggers the alarm reveals what you're optimizing for.</p>
      
      <div class="options-container">
        <div class="option-card" data-q="q2" data-value="messages">
          Responding to messages/Slack
        </div>
        <div class="option-card" data-q="q2" data-value="meetings">
          In a meeting or on a call
        </div>
        <div class="option-card" data-q="q2" data-value="reviewing">
          Reviewing or approving work
        </div>
        <div class="option-card" data-q="q2" data-value="planning">
          Planning or strategizing
        </div>
        <div class="option-card" data-q="q2" data-value="switching">
          Context-switching between tasks
        </div>
      </div>
    </div>

    <!-- QUESTION 3: Deferred Work -->
    <div class="question-section" id="question3">
      <h2 class="question-title">What work did you defer to do that?</h2>
      <p class="question-subtitle">The work you postpone reveals what your system neglects.</p>
      
      <div class="options-container">
        <div class="option-card" data-q="q3" data-value="deep_work">
          Deep work / focused execution
        </div>
        <div class="option-card" data-q="q3" data-value="decisions">
          Decision-making / killing options
        </div>
        <div class="option-card" data-q="q3" data-value="strategy">
          Strategy / big-picture thinking
        </div>
        <div class="option-card" data-q="q3" data-value="learning">
          Learning / skill-building
        </div>
        <div class="option-card" data-q="q3" data-value="shipping">
          Shipping / finishing things
        </div>
      </div>
    </div>

    <!-- RESULT SECTION -->
    <div class="result-section" id="resultSection">
      <div class="result-header">
        <h2 class="result-title" id="resultPairTitle">VISIBILITY vs OWNERSHIP</h2>
        <p class="result-subtitle">Your Conflict Pair</p>
      </div>

      <div class="result-block">
        <div class="result-label">Your Alarm Pattern</div>
        <div class="result-content" id="resultPattern"></div>
      </div>

      <div class="result-block">
        <div class="result-label">Why Your System Does This</div>
        <div class="result-content" id="resultMechanism"></div>
      </div>

      <div class="result-block">
        <div class="result-label">The Reinforcement Loop</div>
        <div class="result-content" id="resultLoop"></div>
      </div>

      <div class="result-block">
        <div class="result-label">What You're Losing</div>
        <div class="result-content" id="resultCost"></div>
      </div>

      <div class="result-highlight">
        <p id="resultHighlight"><strong>Your system is designed to favor visibility over ownership.</strong> That's why the alarm keeps firing. No amount of discipline fixes architectural problems.</p>
      </div>

      <div class="result-block">
        <div class="result-label">The Fix: System Design</div>
        <div class="result-content" id="resultFix"></div>
      </div>

      <!-- EMAIL CAPTURE -->
      <div class="email-capture">
        <h3>Want the full breakdown?</h3>
        <p>Get your conflict pair analysis + 8-week system overview via email.</p>
        <form class="email-form" id="emailForm">
          <input type="email" id="emailInput" placeholder="you@company.com" required>
          <button type="submit">Send Results</button>
        </form>
        <div class="email-success" id="emailSuccess">✓ Check your email for the full analysis.</div>
      </div>

      <!-- CTAs -->
      <a href="/system-map" class="cta-pill">
        Get the 8-Week System →
      </a>
      
      <button class="cta-pill cta-secondary" id="restartBtn">
        Take Diagnostic Again
      </button>
    </div>
  </div>

  <script>
    // State
    const answers = {
      q1: null,
      q2: null,
      q3: null
    };

    let currentQuestion = 1;

    // Conflict Pair Logic with Full Mechanism
    const conflictPairs = {
      // VISIBILITY vs OWNERSHIP
      'messages-deep_work': {
        pair: 'VISIBILITY vs OWNERSHIP',
        pattern: 'Responded to Slack/messages → deferred deep work',
        mechanism: 'Your system rewards responsiveness with <strong>immediate social proof</strong> (Slack replies, gratitude, visibility). Deep work has no immediate signal—just silence. So your operating system learns: <strong>Slack = dopamine, deep work = nothing.</strong>',
        loop: 'Every time you respond quickly, you get validation. Every time you defer deep work, nothing happens today. The alarm fires when deferred work compounds and deadline pressure hits. But by then, you're already behind.',
        cost: 'You're sacrificing <strong>ownership for visibility</strong>. Your technical edge erodes. Your calendar owns you. You're always responsive, never building. You're performing productivity instead of producing output.',
        fix: '<strong>WIP=2 breaks this.</strong> One lane ships (deep work), one waits (maintenance). Slack gets 2 blocks/day max. Deep work gets 3 blocks/day, same time, Mon-Fri. Your system now rewards finishing over responding.',
        favor: 'visibility over ownership'
      },
      'messages-shipping': {
        pair: 'VISIBILITY vs OWNERSHIP',
        pattern: 'Responded to Slack/messages → deferred shipping',
        mechanism: 'Your system rewards <strong>performing responsiveness</strong> (instant replies, being "helpful") while shipping has delayed feedback. Messages give you immediate validation. Finishing things takes weeks to get recognized.',
        loop: 'Every unfinished project stays warm. Every Slack thread gives instant gratification. The alarm fires when you realize you haven't shipped anything in months—but you've been "busy" the whole time.',
        cost: 'You're trading <strong>completion for availability</strong>. Nothing ever closes. Your portfolio is full of 80% done projects. You're known for being responsive, not for shipping.',
        fix: '<strong>WIP=2 + kill-list.</strong> Two projects max: one live (shipping), one maintenance (support). Everything else gets a forcing function: ship by Friday or kill it. Slack goes to 2 blocks/day. Shipping gets priority blocks.',
        favor: 'visibility over ownership'
      },
      'switching-deep_work': {
        pair: 'RESPONSIVENESS vs FOCUS',
        pattern: 'Context-switched between tasks → deferred deep work',
        performed: 'You're optimizing for <strong>keeping all options warm</strong> (reactive availability)',
        mechanism: 'Your system is designed for <strong>reactive availability</strong>—every task feels urgent, so you keep switching. But deep work requires sustained focus. Each context switch costs 15-30 minutes of cognitive reload time.',
        loop: 'You start deep work → get interrupted → switch tasks → feel productive (motion ≠ progress) → repeat. The alarm fires when you realize you spent 8 hours switching but completed nothing that required focus.',
        cost: 'You're sacrificing <strong>depth for breadth</strong>. You touch everything, finish nothing. Your best work—the stuff that requires uninterrupted thought—never happens. You're always in motion, never in momentum.',
        fix: '<strong>Whitelist-only execution blocks.</strong> 50-min deep work sessions, same time daily. Phone off. Slack closed. Calendar blocked. Only pre-approved interruptions (emergency = revenue loss >$10K). Everything else waits.',
        favor: 'responsiveness over focus'
      },
      'switching-shipping': {
        pair: 'RESPONSIVENESS vs FOCUS',
        pattern: 'Context-switched between tasks → deferred shipping',
        mechanism: 'Your system treats <strong>all motion as progress</strong>. Switching between tasks feels productive because you're "doing things." But shipping requires closing loops, which means saying no to everything else.',
        loop: 'You juggle 8 projects → make progress on all → finish none → feel busy but unproductive. The alarm fires when stakeholders ask "where's the deliverable?" and you realize you've been working on everything except the thing that ships.',
        cost: 'You're trading <strong>completion for activity</strong>. Your velocity looks high (lots of tasks started) but throughput is zero (nothing finished). You're stuck in permanent draft mode.',
        fix: '<strong>WIP=1 for shipping.</strong> One project ships this week. Everything else is maintenance or killed. No new work until current work ships. Binary decisions: done or not done. No "90% complete."',
        favor: 'responsiveness over focus'
      },
      // AVAILABILITY vs AUTHORITY
      'meetings-decisions': {
        pair: 'AVAILABILITY vs AUTHORITY',
        pattern: 'Attended meeting/call → deferred decision-making',
        mechanism: 'Your system optimizes for <strong>consensus over clarity</strong>. Meetings give you the illusion of progress (we talked about it!) without forcing decisions. Decision-making means killing options—meetings keep options alive.',
        loop: 'You attend meeting → discuss → defer decision → schedule follow-up → repeat. The alarm fires when you realize you've had 6 meetings about the same thing and still haven't decided.',
        cost: 'You're sacrificing <strong>authority for availability</strong>. Your team is stuck waiting for direction. Velocity drops because no one knows what's prioritized. You're in every conversation but making no calls.',
        fix: '<strong>Decision sprints.</strong> Block 2 hours/week: no meetings, only decisions. Every option gets a forcing function: decide by Friday or kill it. Meetings require pre-work: "What decision are we making?" No decision = no meeting.',
        favor: 'availability over authority'
      },
      'meetings-strategy': {
        pair: 'AVAILABILITY vs AUTHORITY',
        pattern: 'Attended meeting/call → deferred strategy work',
        mechanism: 'Your system rewards <strong>being in the room</strong> (availability) over thinking deeply about direction. Meetings are immediate and social. Strategy work is solitary and has no instant feedback.',
        loop: 'Your calendar fills with meetings → strategy work gets pushed to "later" → you're always reacting, never leading. The alarm fires when you realize you've been fighting fires instead of setting direction.',
        cost: 'You're trading <strong>leadership for presence</strong>. Your team is executing tactically with no strategic vision. You're managing the present instead of designing the future.',
        fix: '<strong>Strategy blocks: non-negotiable.</strong> 3 hours/week, same time, no meetings. Output: one decision memo per week. If it's not in the memo, it's not strategy. Meetings become input to strategy, not replacement for it.',
        favor: 'availability over authority'
      },
      'meetings-deep_work': {
        pair: 'AVAILABILITY vs AUTHORITY',
        pattern: 'Attended meeting/call → deferred deep work',
        mechanism: 'Your system prioritizes <strong>coordination over creation</strong>. Every meeting fragments your day. Deep work requires 2-4 hour blocks. Your calendar has no blocks—just gaps between meetings.',
        loop: 'You accept meeting invite → deep work gets bumped → calendar fills → you work nights/weekends to catch up. The alarm fires when you realize your best thinking happens outside work hours because your calendar is owned by others.',
        cost: 'You're sacrificing <strong>output for input</strong>. You spend all day coordinating, none creating. Your deliverables are always late because you have no time to actually do the work.',
        fix: '<strong>Calendar proof: 5 same-time blocks, Mon-Fri.</strong> These are non-negotiable deep work slots. Meetings book around them, not through them. If someone needs you during deep work, they reschedule.',
        favor: 'availability over authority'
      },
      // QUALITY GATE vs EXECUTION
      'reviewing-shipping': {
        pair: 'QUALITY GATE vs EXECUTION',
        pattern: 'Reviewed/approved work → deferred your own shipping',
        mechanism: 'Your system makes you the <strong>bottleneck by design</strong>. You're the final check for everyone's work, so your own work waits. Reviewing feels productive (you're helping!), but your projects never close.',
        loop: 'Team ships work to you → you review → your work gets pushed → you become the constraint. The alarm fires when you realize your team is waiting on your review, and your stakeholders are waiting on your delivery.',
        cost: 'You're trading <strong>your output for gatekeeping</strong>. Your team is productive. You're not. You're managing quality but producing nothing. Your role becomes "reviewer" instead of "builder."',
        fix: '<strong>Review windows: 2 blocks/week max.</strong> Everything else waits or ships without you. Teach your team to ship without approval. Your job is to build, not to check. If you're the bottleneck, you're the problem.',
        favor: 'gatekeeping over execution'
      },
      'reviewing-deep_work': {
        pair: 'QUALITY GATE vs EXECUTION',
        pattern: 'Reviewed/approved work → deferred deep work',
        mechanism: 'Your system treats <strong>review as higher priority than creation</strong>. Reviewing is reactive (someone needs you now!). Deep work is proactive (no one's waiting). So review always wins.',
        loop: 'Review requests pile up → you clear the queue → your deep work slides → repeat. The alarm fires when you realize you haven't done focused work in weeks—you've only reacted to others.',
        cost: 'You're sacrificing <strong>your edge for quality control</strong>. Your skills atrophy. Your team depends on you to check their work instead of learning to ship independently. You're managing, not making.',
        fix: '<strong>Async review only.</strong> No same-day reviews. All reviews happen in dedicated 2-hour blocks, twice a week. Team learns to ship without immediate feedback. Your deep work gets protected.',
        favor: 'gatekeeping over execution'
      },
      // PLANNING vs EXECUTION
      'planning-shipping': {
        pair: 'PLANNING vs EXECUTION',
        pattern: 'Planned/strategized → deferred shipping',
        mechanism: 'Your system rewards <strong>keeping options open</strong> (planning feels safe) over closing loops (shipping feels risky). Planning never ends—there's always more to consider. Shipping forces commitment.',
        loop: 'You plan → find new consideration → revise plan → defer shipping → repeat. The alarm fires when you realize you've spent 3 months planning something that should've shipped in 3 weeks.',
        cost: 'You're trading <strong>execution for optionality</strong>. Nothing ships because you're always "refining the strategy." Your team is stuck waiting for green light. Competitors ship while you plan.',
        fix: '<strong>Forcing functions: ship by Friday or kill it.</strong> Planning gets 1 week max. After that, execution or death. No permanent planning mode. Test with market, not more planning.',
        favor: 'optionality over execution'
      },
      'planning-deep_work': {
        pair: 'PLANNING vs EXECUTION',
        pattern: 'Planned/strategized → deferred deep work',
        mechanism: 'Your system confuses <strong>thinking about work with doing work</strong>. Planning feels productive (you're making progress!) but deep work is where value compounds. Planning is finite. Execution is where you learn.',
        loop: 'You strategize → feel productive → defer execution → realize nothing moved. The alarm fires when stakeholders ask "what shipped?" and you have 10 strategy docs but zero deliverables.',
        cost: 'You're sacrificing <strong>building for planning</strong>. You're over-indexed on strategy, under-indexed on execution. Your ideas are great. Your output is zero.',
        fix: '<strong>1:3 ratio: planning to execution.</strong> For every 1 hour of planning, 3 hours of deep work execution. Plans get tested with real work, not more planning. Ship to learn, not plan to learn.',
        favor: 'planning over execution'
      },
      // GROWTH vs CAPACITY
      'meetings-learning': {
        pair: 'GROWTH vs CAPACITY',
        pattern: 'Attended meetings → deferred learning/skill-building',
        mechanism: 'Your system optimizes for <strong>scaling the team</strong> (meetings, coordination) over scaling yourself (learning, upskilling). Growth creates coordination overhead. Your time gets consumed managing people, not improving yourself.',
        loop: 'Team grows → meetings multiply → learning gets pushed → your edge dulls. The alarm fires when you realize you haven't learned anything new in 6 months because you're too busy managing.',
        cost: 'You're sacrificing <strong>your capacity for company growth</strong>. Team gets better. You stagnate. Eventually you become the constraint because you stopped investing in your own skills.',
        fix: '<strong>Non-negotiable learning blocks: 3 hours/week.</strong> These are CEO time—untouchable. Read, code, experiment, upskill. If you're not growing, you're the ceiling.',
        favor: 'growth over capacity'
      },
      'reviewing-learning': {
        pair: 'GROWTH vs CAPACITY',
        pattern: 'Reviewed work → deferred learning/skill-building',
        mechanism: 'Your system prioritizes <strong>team output over your development</strong>. Reviewing their work feels urgent. Your learning feels optional. But if you don't grow, you cap the team's potential.',
        loop: 'You review their work → your learning waits → your skills plateau → you can't lead them into new territory. The alarm fires when you realize you're managing yesterday's skills, not building tomorrow's.',
        cost: 'You're trading <strong>your edge for management</strong>. You're a better manager. You're a worse builder. Eventually the team outgrows you.',
        fix: '<strong>Learning is non-negotiable.</strong> 3 hours/week, same as execution time. You can't lead into domains you don't understand. Stop reviewing. Start building.',
        favor: 'growth over capacity'
      },
      // FALLBACK (catch-all)
      'fallback': {
        pair: 'SYSTEM OVERLOAD',
        pattern: 'Constraint violation detected',
        mechanism: 'Your system is running <strong>WIP>capacity</strong>—too many concurrent lanes. Every task feels urgent. Nothing has forcing functions. Your operating system has no exit condition.',
        loop: 'You start new work → old work stays warm → WIP grows → cognitive load spikes. The alarm fires when you realize you're working 60 hours but shipping nothing.',
        cost: 'You're sacrificing <strong>throughput for motion</strong>. High activity, zero velocity. You're busy, not productive.',
        fix: '<strong>WIP=2. Kill everything else.</strong> Two lanes: one ships, one waits. No new work until current work closes. Constraint architecture over willpower.',
        favor: 'keeping options warm over finishing'
      }
    };

    // Elements
    const progressFill = document.getElementById('progressFill');
    const progressText = document.getElementById('progressText');
    const optionCards = document.querySelectorAll('.option-card');

    // Handle option selection
    optionCards.forEach(card => {
      card.addEventListener('click', () => {
        const question = card.dataset.q;
        const value = card.dataset.value;
        
        // Store answer
        answers[question] = value;

        // Track in GA
        gtag('event', 'diagnostic_answer', {
          'event_category': 'engagement',
          'event_label': `${question}_${value}`,
          'value': currentQuestion
        });

        // Visual feedback
        document.querySelectorAll(`[data-q="${question}"]`).forEach(c => c.classList.remove('selected'));
        card.classList.add('selected');

        // Wait briefly then advance
        setTimeout(() => {
          advanceQuestion();
        }, 300);
      });
    });

    function advanceQuestion() {
      // Hide current question
      document.getElementById(`question${currentQuestion}`).classList.remove('active');

      // Advance
      currentQuestion++;

      // Update progress
      const progress = (currentQuestion - 1) / 3 * 100;
      progressFill.style.width = `${progress}%`;

      if (currentQuestion <= 3) {
        // Show next question
        progressText.textContent = `Question ${currentQuestion} of 3`;
        document.getElementById(`question${currentQuestion}`).classList.add('active');
      } else {
        // Show result
        progressText.textContent = 'Complete';
        progressFill.style.width = '100%';
        showResult();
      }
    }

    function showResult() {
      const key = `${answers.q2}-${answers.q3}`;
      const result = conflictPairs[key] || conflictPairs['fallback'];

      // Populate result
      document.getElementById('resultPairTitle').textContent = result.pair;
      document.getElementById('resultPattern').innerHTML = result.pattern;
      document.getElementById('resultMechanism').innerHTML = result.mechanism;
      document.getElementById('resultLoop').innerHTML = result.loop;
      document.getElementById('resultCost').innerHTML = result.cost;
      document.getElementById('resultFix').innerHTML = result.fix;
      document.getElementById('resultHighlight').innerHTML = `<strong>Your system is designed to favor ${result.favor}.</strong> That's why the alarm keeps firing. No amount of discipline fixes architectural problems.`;

      // Track in GA
      gtag('event', 'diagnostic_complete', {
        'event_category': 'conversion',
        'event_label': result.pair,
        'value': 1
      });

      // Show result section
      document.getElementById('resultSection').classList.add('active');
      document.getElementById('resultSection').scrollIntoView({ behavior: 'smooth', block: 'start' });
    }

    // Email capture
    document.getElementById('emailForm').addEventListener('submit', async (e) => {
      e.preventDefault();
      
      const email = document.getElementById('emailInput').value;
      const key = `${answers.q2}-${answers.q3}`;
      const result = conflictPairs[key] || conflictPairs['fallback'];

      try {
        // Send to backend
        const response = await fetch('/api/submit-diagnostic', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            email,
            answers,
            conflictPair: result.pair,
            timestamp: new Date().toISOString()
          })
        });

        if (response.ok) {
          // Track in GA
          gtag('event', 'diagnostic_email_capture', {
            'event_category': 'conversion',
            'event_label': result.pair,
            'value': 1
          });

          // Show success
          document.getElementById('emailSuccess').classList.add('show');
          document.getElementById('emailForm').style.display = 'none';
        }
      } catch (error) {
        console.error('Error:', error);
        alert('Something went wrong. Please try again.');
      }
    });

    // Restart
    document.getElementById('restartBtn').addEventListener('click', () => {
      // Reset state
      answers.q1 = null;
      answers.q2 = null;
      answers.q3 = null;
      currentQuestion = 1;

      // Reset UI
      optionCards.forEach(card => card.classList.remove('selected'));
      document.querySelectorAll('.question-section').forEach(q => q.classList.remove('active'));
      document.getElementById('question1').classList.add('active');
      document.getElementById('resultSection').classList.remove('active');
      
      progressFill.style.width = '0%';
      progressText.textContent = 'Question 1 of 3';

      // Scroll to top
      window.scrollTo({ top: 0, behavior: 'smooth' });

      // Track in GA
      gtag('event', 'diagnostic_restart', {
        'event_category': 'engagement',
        'value': 1
      });
    });
  </script>
</body>
</html>
